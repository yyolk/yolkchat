{"ts":1351445522490,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"$.log = function(m) {\n  if (window && window.console && window.console.log) {\n    window.console.log(arguments.length == 1 ? m : arguments);\n  }\n};\n\n// http://stackoverflow.com/questions/1184624/serialize-form-to-json-with-jquery/1186309#1186309\n$.fn.serializeObject = function() {\n    var o = {};\n    var a = this.serializeArray();\n    $.each(a, function() {\n        if (o[this.name]) {\n            if (!o[this.name].push) {\n                o[this.name] = [o[this.name]];\n            }\n            o[this.name].push(this.value || '');\n        } else {\n            o[this.name] = this.value || '';\n        }\n    });\n    return o;\n};\n\n// todo remove this crap\nfunction escapeHTML(st) {                                       \n  return(                                                                 \n    st && st.replace(/&/g,'&amp;').                                         \n      replace(/>/g,'&gt;').                                           \n      replace(/</g,'&lt;').                                           \n      replace(/\"/g,'&quot;')                                         \n  );                                                                     \n};\n\nfunction safeHTML(st, len) {\n  return st ? escapeHTML(st.substring(0,len)) : '';\n}\n\n// todo this should take a replacement template\n$.linkify = function(body) {\n  return body.replace(/((ftp|http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-\\/]))?)/gi,function(a) {\n    return '<a target=\"_blank\" href=\"'+a+'\">'+a+'</a>';\n  }).replace(/\\@([\\w\\-]+)/g,function(user,name) {\n    return '<a href=\"#/mentions/'+encodeURIComponent(name.toLowerCase())+'\">'+user+'</a>';\n  }).replace(/\\#([\\w\\-\\.]+)/g,function(word,tag) {\n    return '<a href=\"#/tags/'+encodeURIComponent(tag.toLowerCase())+'\">'+word+'</a>';\n  });\n};\n\n$.fn.prettyDate = function() {\n  $(this).each(function() {\n    var string, title = $(this).attr(\"title\");\n    if (title) {\n      string = $.prettyDate(title);\n    } else {\n      string = $.prettyDate($(this).text());\n    }\n    $(this).text(string);\n  });\n};\n\n$.prettyDate = function(time){\n  \n\tvar date = new Date(time.replace(/-/g,\"/\").replace(\"T\", \" \").replace(\"Z\", \" +0000\").replace(/(\\d*\\:\\d*:\\d*)\\.\\d*/g,\"$1\")),\n\t\tdiff = (((new Date()).getTime() - date.getTime()) / 1000),\n\t\tday_diff = Math.floor(diff / 86400);\n\n  if (isNaN(day_diff)) return time;\n\n\treturn day_diff < 1 && (\n\t\t\tdiff < 60 && \"just now\" ||\n\t\t\tdiff < 120 && \"1 minute ago\" ||\n\t\t\tdiff < 3600 && Math.floor( diff / 60 ) + \" minutes ago\" ||\n\t\t\tdiff < 7200 && \"1 hour ago\" ||\n\t\t\tdiff < 86400 && Math.floor( diff / 3600 ) + \" hours ago\") ||\n\t\tday_diff == 1 && \"yesterday\" ||\n\t\tday_diff < 21 && day_diff + \" days ago\" ||\n\t\tday_diff < 45 && Math.ceil( day_diff / 7 ) + \" weeks ago\" ||\n    time;\n    // day_diff < 730 && Math.ceil( day_diff / 31 ) + \" months ago\" ||\n    // Math.ceil( day_diff / 365 ) + \" years ago\";\n};\n\n$.argsToArray = function(args) {\n  if (!args.callee) return args;\n  var array = [];\n  for (var i=0; i < args.length; i++) {\n    array.push(args[i]);\n  };\n  return array;\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":3051}]],"length":3051}
